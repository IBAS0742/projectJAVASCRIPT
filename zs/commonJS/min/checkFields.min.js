function checkFields(e){var t,a=!0;try{t=Array.prototype.slice.call($$("[data-check]"))}catch(t){if(console.log(t),e)return;checkFields(1)}return t.forEach(function(e){if(a){var t,r=$$(e),n=r.attr("data-check");n&&("#"!=(t="true"==n?r.attr("type"):r.attr("data-check"))[0]?(t in regExt||(t="default"),a=checkOneFieldHelp(t,e)):$$("[ajax-name='"+t.substring(1)+"']").length&&(a=checkOneFieldHelp($$("[ajax-name='"+t.substring(1)+"']")[0],r[0])))}}),a}function autoCheckFields(e){var t;try{t=Array.prototype.slice.call($$("[data-check]"))}catch(t){if(console.log(t),e)return;autoCheckFields(1)}t.forEach(function(e){var t,a=$$(e),r=a.attr("data-check");r&&("#"!=(t="true"==r?a.attr("type"):a.attr("data-check"))[0]?(t in regExt||(t="default"),checkOneFieldClosure(t,a)):$$("[ajax-name='"+t.substring(1)+"']").length&&checkOneFieldClosure($$("[ajax-name='"+t.substring(1)+"']")[0],a))})}function checkFieldsAndSubmit(e,t){if(!e)throw new Error("obj 为空");if(e.data={},e._data)for(var a in e._data)e.data[a]=e._data[a];checkFields()?(Array.prototype.slice.call($$("[ajax-name]")).forEach(function(t){var a=$$(t);if(a.attr("ajax-data")){var r=getFnFromString(a.attr("ajax-data"));r instanceof Function?e.data[a.attr("ajax-name")]=r():console.error(a+" 不是正确的函数名称")}else e.data[a.attr("ajax-name")]=t.value}),t?t(e):$$.ajax(e)):console.log("参数有误")}if(!$$)throw new Error("$$ 没有定义");var getFnFromString=function(e){var t=window;return e.split(".").forEach(function(e){e in t&&(t=t[e])}),t},checkOneFieldClosure=function(e,t){return checkOneField(e,t)},checkOneField=function(e,t){t.on("change",function(t){checkOneFieldHelp(e,t.target)})},checkOneFieldHelp=function(e,t){var a=$$(t),r=!1;if(t.value=t.value.toString().trim(),a.attr("data-check-before")){var n=getFnFromString(a.attr("data-check-before"))(t.value);if(!n.isOk)return n.errMsg&&$$.toast(n.errMsg),void(n.fvalue&&(t.value=n.fvalue));t.value=n.value}return e instanceof Element?t.value==e.value&&(r=!0):regExt[e](t.value)&&(r=!0),r?(t.style.color="green",t.style.textDecoration="none"):(toast.show(a.attr("error-msg")?a.attr("error-msg"):"红色标记部分错误！"),t.style.color="red",t.style.textDecoration="line-through",a.once("keypress",function(e){t.style.color="green",t.style.textDecoration="none"})),r};